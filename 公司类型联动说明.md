# 公司类型联动功能说明

## 更新日期
2025-10-21

## 功能概述

实现了**公司类型根据选择的国家地区动态提供候选项**的功能，不同国家/地区现在会显示符合当地法律规定的公司类型选项。

---

## 核心功能

### 1. 动态公司类型加载

当用户选择不同的注册地区时，公司类型下拉框会自动更新，显示该国家/地区特有的公司类型选项。

**特点**：
- ✅ 热门公司类型自动标记星号 ★ 并置顶
- ✅ 按照流行度排序（popular: true 的选项在前）
- ✅ 包含完整的双语说明
- ✅ 智能保留用户之前的选择（如果新列表中有相同类型）

---

## 已配置国家的公司类型

### 🇭🇰 香港 (HK)

| 类型值 | 显示名称 | 热门 |
|--------|---------|------|
| Limited | ★ Private Limited Company (私人有限公司) - Ltd | ✓ |
| PublicLimited | Public Limited Company (公众有限公司) - PLC | - |
| Branch | Branch Office (分公司) | - |
| RepOffice | Representative Office (代表处) | - |

**特点**：
- 私人有限公司最常见，标记为热门
- 支持公众有限公司（上市公司结构）
- 可注册分公司和代表处

---

### 🇸🇬 新加坡 (SG)

| 类型值 | 显示名称 | 热门 |
|--------|---------|------|
| PteLtd | ★ Private Limited (私人有限公司) - Pte Ltd | ✓ |
| PublicLtd | Public Limited (公众有限公司) - Ltd | - |
| Branch | Branch Office (分公司) | - |
| RepOffice | Representative Office (代表处) | - |
| LLP | Limited Liability Partnership (有限责任合伙) - LLP | - |

**特点**：
- Pte Ltd 是新加坡最常见的公司类型
- 支持有限责任合伙（适合专业服务）
- 包含分公司和代表处选项

---

### 🇺🇸 美国 (US)

| 类型值 | 显示名称 | 热门 |
|--------|---------|------|
| LLC | ★ Limited Liability Company (有限责任公司) - LLC | ✓ |
| Corp | ★ Corporation (股份有限公司) - Corp / Inc | ✓ |
| SCorp | S Corporation (S型公司) - S-Corp | - |
| Branch | Branch Office (分公司) | - |
| LLP | Limited Liability Partnership (有限责任合伙) - LLP | - |

**特点**：
- LLC 和 Corp 是两种最常见的公司类型，都标记为热门
- S Corporation 是特殊税务结构，适合中小企业
- 支持多种合伙和分公司结构

---

### 🇬🇧 英国 (UK)

| 类型值 | 显示名称 | 热门 |
|--------|---------|------|
| Limited | ★ Private Limited Company (私人有限公司) - Ltd | ✓ |
| PLC | Public Limited Company (公众有限公司) - PLC | - |
| LLP | Limited Liability Partnership (有限责任合伙) - LLP | - |
| Branch | Branch Office (分公司) | - |

**特点**：
- Private Limited (Ltd) 是英国最常见的公司类型
- PLC 适合上市公司
- LLP 适合专业服务公司（律师、会计师等）

---

### 🏝️ 英属维尔京群岛 (BVI)

| 类型值 | 显示名称 | 热门 |
|--------|---------|------|
| BC | ★ Business Company (BVI商业公司) - BC | ✓ |
| Limited | Limited Company (有限公司) - Ltd | - |

**特点**：
- Business Company 是 BVI 的标准离岸公司类型
- 结构简单，适合国际投资和控股

---

### 🏝️ 开曼群岛 (Cayman)

| 类型值 | 显示名称 | 热门 |
|--------|---------|------|
| ExemptedCompany | ★ Exempted Company (豁免公司) | ✓ |
| OrdinaryCompany | Ordinary Resident Company (普通居民公司) | - |
| LLC | Limited Liability Company (LLC) | - |

**特点**：
- Exempted Company 是开曼最常见的离岸公司类型
- 适合国际业务和上市架构
- 享受税务豁免待遇

---

## 通用公司类型（未特定配置的国家）

对于没有特定配置的国家，系统会自动提供以下通用公司类型：

| 类型值 | 显示名称 | 热门 |
|--------|---------|------|
| LLC | ★ Limited Liability Company (有限责任公司) - LLC | ✓ |
| Corp | ★ Corporation (股份有限公司) - Corp | ✓ |
| Limited | ★ Private Limited (私人有限公司) - Ltd | ✓ |
| Branch | Branch (分公司) | - |

**涵盖国家**：
- 日本、韩国、马来西亚、泰国、越南等亚洲国家
- 德国、法国、爱尔兰等欧洲国家
- 加拿大、墨西哥、巴西等美洲国家
- 澳大利亚、新西兰等大洋洲国家
- 其他所有离岸金融中心

---

## 技术实现

### 数据结构

在 [`data.js`](file:///Users/moxin/Qcoder/overseas-company-setup/data.js) 中，每个国家配置添加了 `companyTypes` 字段：

```javascript
'US': {
    name: '美国',
    // ... 其他配置
    companyTypes: [
        { 
            value: 'LLC', 
            label: 'Limited Liability Company (有限责任公司) - LLC', 
            popular: true 
        },
        { 
            value: 'Corp', 
            label: 'Corporation (股份有限公司) - Corp / Inc', 
            popular: true 
        },
        // ... 更多类型
    ],
    // ...
}
```

**字段说明**：
- `value`: 公司类型的值（用于表单提交）
- `label`: 显示给用户的完整双语名称
- `popular`: 是否为热门类型（热门类型会添加星号标记并置顶）

---

### 核心函数

#### 1. `handleJurisdictionChange(jurisdictionCode)`

**功能**：处理注册地变化事件

**流程**：
```
1. 获取选中的国家配置
2. 读取该国家的 companyTypes 或使用 DEFAULT_COMPANY_TYPES
3. 调用 updateCompanyTypes() 更新公司类型选项
4. 同时处理子地区（州/城市）的联动
```

**代码位置**：[`app.js`](file:///Users/moxin/Qcoder/overseas-company-setup/app.js#L18-L88)

---

#### 2. `updateCompanyTypes(companyTypes)`

**功能**：更新公司类型下拉框的选项

**流程**：
```
1. 保存用户当前选择的值
2. 清空现有选项
3. 按照 popular 字段排序
4. 为热门类型添加 ★ 标记
5. 添加所有选项到下拉框
6. 如果用户之前选择的类型在新列表中，保持选中状态
```

**特点**：
- 智能排序：热门类型自动置顶
- 视觉标识：热门类型前添加星号 ★
- 状态保持：尽可能保留用户之前的选择

**代码位置**：[`app.js`](file:///Users/moxin/Qcoder/overseas-company-setup/app.js#L90-L112)

---

#### 3. `initializeForm()`

**功能**：页面加载时初始化表单

**新增逻辑**：
```javascript
// 初始化时加载默认公司类型
updateCompanyTypes(DEFAULT_COMPANY_TYPES);
```

**作用**：
- 在用户选择国家之前，显示通用的公司类型选项
- 避免下拉框为空的情况

---

## 用户体验优化

### 1. 热门标记

热门公司类型会自动添加 ★ 标记并置顶显示：

```
★ Limited Liability Company (有限责任公司) - LLC
★ Corporation (股份有限公司) - Corp / Inc
S Corporation (S型公司) - S-Corp
Branch Office (分公司)
```

### 2. 智能排序

选项按照以下规则排序：
1. 热门类型（`popular: true`）在前
2. 普通类型在后
3. 同类型内保持配置顺序

### 3. 状态保持

当用户切换国家后：
- 如果新国家也支持用户之前选择的公司类型，保持选中
- 例如：选了 LLC，从美国切换到英国，如果英国也有 LLC，继续选中

### 4. 提示信息

在公司类型下拉框下方添加了提示：
```
Company types vary by jurisdiction (不同国家的公司类型不同)
```

---

## 联动关系图

```
用户操作: 选择注册地区
    ↓
handleJurisdictionChange()
    ↓
获取国家配置中的 companyTypes
    ↓
updateCompanyTypes(companyTypes)
    ↓
1. 按 popular 排序
2. 添加 ★ 标记
3. 更新下拉框选项
4. 保持用户选择（如果可能）
```

---

## 扩展性

### 添加新国家的公司类型

只需在 [`data.js`](file:///Users/moxin/Qcoder/overseas-company-setup/data.js) 中对应国家配置添加 `companyTypes` 字段：

```javascript
'XX': {
    name: '某国',
    // ... 其他配置
    companyTypes: [
        { 
            value: 'Type1', 
            label: 'Type Name (类型名称)', 
            popular: true 
        },
        { 
            value: 'Type2', 
            label: 'Another Type (另一类型)', 
            popular: false 
        }
    ],
    // ...
}
```

**注意事项**：
- `value` 应该使用简洁的英文标识符
- `label` 使用 "English(中文)" 双语格式
- 最常见的1-2种类型设置 `popular: true`
- 如果不配置 `companyTypes`，会自动使用 `DEFAULT_COMPANY_TYPES`

---

### 修改默认公司类型

编辑 [`data.js`](file:///Users/moxin/Qcoder/overseas-company-setup/data.js) 中的 `DEFAULT_COMPANY_TYPES`：

```javascript
const DEFAULT_COMPANY_TYPES = [
    { value: 'LLC', label: 'Limited Liability Company (有限责任公司) - LLC', popular: true },
    { value: 'Corp', label: 'Corporation (股份有限公司) - Corp', popular: true },
    { value: 'Limited', label: 'Private Limited (私人有限公司) - Ltd', popular: true },
    { value: 'Branch', label: 'Branch (分公司)', popular: false }
];
```

---

## 测试场景

### 场景1：选择香港

**操作**：
1. 打开应用
2. 选择注册地区：香港

**预期结果**：
- 公司类型自动更新为：
  - ★ Private Limited Company (私人有限公司) - Ltd
  - Public Limited Company (公众有限公司) - PLC
  - Branch Office (分公司)
  - Representative Office (代表处)

---

### 场景2：从美国切换到英国

**操作**：
1. 选择注册地区：美国
2. 选择公司类型：LLC
3. 切换注册地区：英国

**预期结果**：
- 公司类型选项更新为英国的类型
- 由于英国也有 LLP，但没有 LLC，公司类型被重置为"请选择"
- （如果英国配置了 LLC，则会保持选中状态）

---

### 场景3：选择未配置的国家

**操作**：
1. 选择注册地区：日本（未特定配置公司类型）

**预期结果**：
- 公司类型显示默认通用类型：
  - ★ Limited Liability Company (有限责任公司) - LLC
  - ★ Corporation (股份有限公司) - Corp
  - ★ Private Limited (私人有限公司) - Ltd
  - Branch (分公司)

---

### 场景4：切换到离岸金融中心

**操作**：
1. 选择注册地区：BVI 英属维尔京群岛

**预期结果**：
- 公司类型更新为 BVI 特有类型：
  - ★ Business Company (BVI商业公司) - BC
  - Limited Company (有限公司) - Ltd

---

## 数据完整性

### 已配置国家/地区（6个）

| 国家/地区 | 代码 | 公司类型数量 | 热门类型数量 |
|-----------|------|--------------|--------------|
| 香港 | HK | 4 | 1 |
| 新加坡 | SG | 5 | 1 |
| 美国 | US | 5 | 2 |
| 英国 | UK | 4 | 1 |
| 英属维尔京群岛 | BVI | 2 | 1 |
| 开曼群岛 | Cayman | 3 | 1 |

### 使用默认配置的国家/地区（30+个）

所有其他国家使用 `DEFAULT_COMPANY_TYPES`（4种通用类型）

---

## 优势与价值

### 1. 合规性
- 每个国家显示符合当地法律的公司类型
- 避免用户选择不可用的公司类型
- 减少后续沟通成本

### 2. 专业性
- 展示平台对各国公司法的了解
- 提供准确的专业信息
- 提升用户信任度

### 3. 用户体验
- 自动筛选，减少选择困难
- 热门标记帮助用户快速决策
- 智能保持用户选择

### 4. 可扩展性
- 简单的配置结构
- 易于添加新国家
- 通用默认类型保底

---

## 后续优化方向

### 1. 添加更多国家的特定配置
目前只配置了6个主要国家，可以继续添加：
- 德国、法国等欧洲国家
- 日本、韩国等亚洲国家
- 澳大利亚、加拿大等

### 2. 公司类型详细说明
为每种公司类型添加：
- 详细描述（适用场景、优缺点）
- 最低资本要求
- 股东/董事人数要求
- 税务特点

### 3. 智能推荐
基于用户的业务范围和需求，推荐最适合的公司类型

### 4. 对比功能
允许用户对比不同公司类型的特点

---

## 文件修改清单

### 修改的文件

1. **`data.js`** (+38行)
   - 为 HK、SG、US、UK、BVI、Cayman 添加 `companyTypes` 配置
   - 新增 `DEFAULT_COMPANY_TYPES` 常量

2. **`app.js`** (+44行)
   - 修改 `handleJurisdictionChange()` - 添加公司类型更新逻辑
   - 新增 `updateCompanyTypes()` 函数 - 核心联动逻辑
   - 修改 `initializeForm()` - 初始化时加载默认类型

3. **`index.html`** (-2行)
   - 移除公司类型的硬编码选项
   - 添加动态加载提示

---

## 总结

✅ **功能完整**：已实现公司类型根据国家地区动态联动
✅ **用户友好**：热门标记、智能排序、状态保持
✅ **可扩展**：简单的配置结构，易于添加新国家
✅ **专业性**：符合各国法律规定的公司类型选项
✅ **双语支持**：所有选项采用 "English(中文)" 格式

**核心价值**：
- 提升合规性：只显示符合当地法律的公司类型
- 增强专业性：展示对各国公司法的深入了解
- 优化体验：自动筛选，减少用户选择困难
- 降低成本：减少后续因选错类型导致的沟通成本

---

**功能已上线，可立即体验！** 🚀
